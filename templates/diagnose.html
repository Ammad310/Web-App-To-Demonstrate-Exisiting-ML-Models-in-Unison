<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Diagnose Disease</title>
</head>

<body>
    <!-- Diagnosed Disease Information -->
    <section class="py-20 mt-15">
        <div class="sm:w-3/4 lg:w-5/12 mx-auto px-2">
            <h1 class="text-3xl text-center text-gold">Diagnosed Disease</h1>
            <p class="text-white text-lg text-center mt-4">The diagnosis results will be displayed here.</p>
        </div>
    </section>

    <div class="container">
        <!-- Left Side: Patient Information and Vitals -->
        <div class="left-side">
            <!-- Personal Information Section -->
            <div>
                <button class="collapsible">Personal Information</button>
                <div class="content">
                    <p id="dob">Date of Birth: {{data["Date_Of_Birth"]}}</p>
                    <p id="gender">Gender: {{data["Gender"]}}</p>
                    <p id="marital-status">Marital Status: {{data["MaritalStatus"]}}</p>
                    <p id="races">Races: {{data["Races"]}}</p>
                </div>
            </div>

            <!-- Vitals Section -->
            <div>
                <button class="collapsible">Vitals</button>
                <div class="content">
                    <p id="weight">Weight: {{data["Vitals"]["Weight"]}}lbs</p>
                    <p id="height">Height: {{data["Vitals"]["Height"]}}</p>
                    <p id="systolic">Systolic: {{data["Vitals"]["Systolic"]}}</p>
                    <p id="diastolic">Diastolic: {{data["Vitals"]["Diastolic"]}}</p>
                    <p id="pulse">Pulse: {{data["Vitals"]["Pulse"]}}</p>
                    <p id="respiration">Respiration: {{data["Vitals"]["Respiration"]}}</p>
                </div>
            </div>
             <!-- Diagnosis Section -->
             <div>
                <button class="collapsible">Diagnosis</button>
                <div class="content">
                    <p id="weight">Weight: {{data["Vitals"]["Weight"]}}lbs</p>
                    <p id="height">Height: {{data["Vitals"]["Height"]}}</p>
                    <p id="systolic">Systolic: {{data["Vitals"]["Systolic"]}}</p>
                    <p id="diastolic">Diastolic: {{data["Vitals"]["Diastolic"]}}</p>
                    <p id="pulse">Pulse: {{data["Vitals"]["Pulse"]}}</p>
                    <p id="respiration">Respiration: {{data["Vitals"]["Respiration"]}}</p>
                </div>
            </div>
             <!-- Family History Section -->
             <div>
                <button class="collapsible">Family History</button>
                <div class="content">
                    {% for member in data["FamilyHistory"] %}
                        <button class="collapsible">{{ member["FamilyMember"] }}</button>
                        <div class="content">
                            {% for disease in member["Diseases"] %}
                                <p>{{ disease["DiseaseName"] }} - {% if disease["Denies"] %} Yes {% else %} No {% endif %}</p>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Right Side: Disease Predictions, Trajectories, and Medlabs Response -->
        <div class="right-side">
            <!-- Disease Prediction Section -->
            <div class="model-section">
                <button class="collapsible">Disease Prediction</button>
                <div class="content">
                    <button class="collapsible">Sub Result 1</button>
                    <div class="content">
                        <p>Detail Information 1</p>
                    </div>
                    <button class="collapsible">Sub Result 2</button>
                    <div class="content">
                        <p>Detail Information 2</p>
                    </div>
                </div>
            </div>

            <!-- Disease Trajectories Section -->
            <div class="model-section">
                <button class="collapsible">Disease Trajectories</button>
                <div class="content">
                    <button class="collapsible">Sub Result 1</button>
                    <div class="content">
                        <p>Detail Information 1</p>
                    </div>
                    <button class="collapsible">Sub Result 2</button>
                    <div class="content">
                        <p>Detail Information 2</p>
                    </div>
                </div>
            </div>

            <!-- Medlabs Response Section -->
            <div class="model-section">
                <button class="collapsible">Medlabs Response</button>
                <div class="content">
                    <button class="collapsible">Sub Result 1</button>
                    <div class="content">
                        <p>Detail Information 1</p>
                    </div>
                    <button class="collapsible">Sub Result 2</button>
                    <div class="content">
                        <p>Detail Information 2</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            const PID = 'patient-id-placeholder'; // Replace with actual logic to get PID
            const practice = 'practice-placeholder'; // Replace with actual logic to get practice

            const response = await fetch(`/get_patient_data?PID=${PID}&PP=${practice}`);
            const data = await response.json();

            document.getElementById("dob").textContent = "Date of Birth: " + data.Date_Of_Birth;
            document.getElementById("gender").textContent = "Gender: " + data.Gender;
            document.getElementById("marital-status").textContent = "Marital Status: " + (data.MaritalStatus || "N/A");
            document.getElementById("races").textContent = "Races: " + (data.Races.join(", ") || "N/A");

            document.getElementById("weight").textContent = "Weight: " + data.Vitals.Weight;
            document.getElementById("height").textContent = "Height: " + data.Vitals.Height;
            document.getElementById("systolic").textContent = "Systolic: " + data.Vitals.Systolic;
            document.getElementById("diastolic").textContent = "Diastolic: " + data.Vitals.Diastolic;
            document.getElementById("pulse").textContent = "Pulse: " + data.Vitals.Pulse;
            document.getElementById("respiration").textContent = "Respiration: " + data.Vitals.Respiration;
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const collapsibles = document.querySelectorAll('.collapsible');

            collapsibles.forEach(button => {
                button.addEventListener('click', function () {
                    // Toggle the 'active' class on the clicked button
                    this.classList.toggle('active');

                    // Get the next sibling element (the content)
                    const content = this.nextElementSibling;

                    // Toggle the display of the content
                    if (content.style.display === 'block') {
                        content.style.display = 'none';
                    } else {
                        content.style.display = 'block';
                    }
                });
            });
        });
    </script>

</body>
</html>